<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Synthetic Mind" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Synthetic Mind" /> <title> TRAINING GAME AGENTS WITH SUPERVISED LEARNING - Synthetic Mind </title> <link rel="alternate" href="http://localhost:4000/supervisedagents/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/supervisedagents/" /> <meta name="description" content="Supervised Agents." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="TRAINING GAME AGENTS WITH SUPERVISED LEARNING | username" /> <meta property="og:title" content="TRAINING GAME AGENTS WITH SUPERVISED LEARNING | username" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/supervisedagents/" /> <meta property="og:description" content="Supervised Agents." /> <meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="TRAINING GAME AGENTS WITH SUPERVISED LEARNING | username" /> <meta name="twitter:url" content="http://localhost:4000/supervisedagents/" /> <meta name="twitter:site" content="@username" /> <meta name="twitter:creator" content="@username" /> <meta name="twitter:description" content="Supervised Agents." /> <meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Synthetic Mind" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"> <a class="menu-link" href="/">home</a> <a class="menu-link" href="/about/">about</a> <a class="menu-link" href="/notes/">notes</a> <a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#lunar-lander">LUNAR LANDER</a>, <a class="tag" href="/tags/#cartpole">CARTPOLE</a>, <a class="tag" href="/tags/#supervised-learning">SUPERVISED LEARNING</a> </span> </div> <h1 class="header-title" itemprop="headline">TRAINING GAME AGENTS WITH SUPERVISED LEARNING</h1> <div class="post-meta"> <time datetime="2020-06-01T01:00:00+07:00" itemprop="datePublished"> Jun 01, 2020 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Synthetic Mind</span> </span> <time hidden datetime="2020-06-01T16:49:47+07:00" itemprop="dateModified"> Jun 01, 2020 </time> <span hidden itemprop="publisher" itemtype="Person">Synthetic Mind</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><iframe width="600" height="315" src="https://www.youtube.com/embed/0fAOLhMN1n8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <iframe width="600" height="315" src="https://www.youtube.com/embed/0fAOLhMN1n8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe> <h6 id="an-agent-trained-with-supervised-learinng-on-the-lunar-lander-environment"> <em>An agent trained with supervised learinng on the Lunar lander environment.</em> </h6> <p>Reinforcement Learning is a general, robust and performant paradigm. Its strengths become evident when combined with deep learning. Deep reinforcement learning can solve increasingly complex tasks with huge state space and complex rules. It has produced world champion-beating artificial agents in the games of chess, DOTA, go, and Starcraft. One may argue that any problem where scores are received for performing actions should be framed as a reinforcement learning problem. But behind these notable successes, lies huge problems. Deep reinforcement learning is hard to work with. A lot of effort goes into making agents learn correctly and robustly. Deep reinforcement learning also needs a huge amount of compute. Hundreds of thousands of dollars in compute is needed to reproduce the most impressive results. A lone researcher with limited resources cannot comfortably go beyond Atari games state space when experimenting with game playing agents.</p> <p>Lots of effort has been made to improve the sample efficiency of these deep RL algorithms. Model based reinforcement learning is a promising research direction. The environment dynamics can be mastered using supervised/ self-supervised learning, then smaller representations can be used to learn to maximise cumulative reward. This paradigm is attractive because once you learn representations of the state, you may use any kind of valid algorithm to maximise rewards.</p> <p>Another promising paradigm is Upside down RL, where the appropriate action to take in a given state is learned by injecting additional information when learning to map state to actions. In settings where this has worked, an expected goal, in addition to the state, is used as input. The agent is trained to produce actions that reach the goal. The goal in this case is to gain a given reward in a given number of time steps. Inspiration from this paradigm leads me to this month’s article.</p> <p>We know that we can use a neural network to map state to actions and use a reward proxy in our loss function to maximise the probability that the actions taken will yield the highest reward. An example of this loss function is the policy gradient loss:</p> <figure> <img src="https://raw.githubusercontent.com/syntheticmindAI/syntheticmindAI.github.io/master/_posts/supervisedagents/loss.png" alt="Policy Gradient" /> <figcaption>Policy Gradient.</figcaption> </figure> <p>As shown above to get the gradient we not only need the episode trajectories in the actions a(t), predicted by phi given a state s(t), we also need to have Ø(t) which is a form of the reward function. Adding this Ø(t) to our loss function can make the agent harder to train and introduces a host of new hyperparameters to tune. Although there have been a number of improvements to replace the Ø(t) function. A valid research question to ask is if we can remove the reward from our loss function and still have an agent perform actions that maximise reward.</p> <p>Imitation learning, where a set of human/expert demonstrations are used to train a policy has been successful in training robust game plating agents. But this method needs human/ expert demonstrations in the first place. This is an inefficient and low yield way of collecting data for training a policy.</p> <p>A better approach given the constraints, is to find a way that we can collect high quality data for supervised learning without using any kind of demonstrations. We define high quality data as state action pairs that can be used to improve a suboptimal policy. In this first article in the series, we explore the use of the reward function to select high quality state action pairs for the model to train on. In this way we get rid of Ø(t) and also show that we can get promising results on toy tasks, while using a much simpler loss function.</p> <h4 id="high-quality-episode-selection-using-a-reward-heuristic"> <a href="#high-quality-episode-selection-using-a-reward-heuristic" class="anchor-head"></a> HIGH QUALITY EPISODE SELECTION USING A REWARD HEURISTIC </h4> <p>The simplest choice of a heuristic for obtaining high quality data is using the top K rewards . This data that can be collected by performing probabilistic actions with our current policy and sorting the episodes by rewards from highest to lowest. We can then randomly pick state action pairs from the top K episodes and use them to train a neural network.</p> <p>To explain this method step by step:</p> <ol> <li>Initialise a neural network <strong>f(x)</strong> that takes states as input and outputs actions</li> <li>Collect data by using <strong>f(x)</strong> to collect state-action pairs for N number of episodes.</li> <li>Sort the episode data by reward from highest to lowest.</li> <li>Select top K episodes and sample state action action pairs from these</li> <li>Train <strong>f(x)</strong> with these state action pairs</li> <li>Repeat from 2 till reward is satisfactory.</li> </ol> <h4 id="results"> <a href="#results" class="anchor-head"></a> Results </h4> <p>We use the above method to maximise rewards on two open ai gym tasks: CartPole and Lunar Lander.</p> <h5 id="cartpole-results"> CartPole Results </h5> <p>The model can consistently get to the top score of 200 in the environment:</p> <figure> <img src="https://raw.githubusercontent.com/syntheticmindAI/syntheticmindAI.github.io/master/_posts/supervisedagents/perfectcartpole.png" alt="cartpole reward" /> <figcaption>Batch size = 256; max timesteps = 70; updates per iter: 100; episodes sampled per iter: 150</figcaption> </figure> <h5 id="lunar-lander-results"> Lunar Lander Results </h5> <p>However, the same fixed hyperparameters do not work in the LunarLander environment.</p> <figure> <img src="https://raw.githubusercontent.com/syntheticmindAI/syntheticmindAI.github.io/master/_posts/supervisedagents/badlunarrew.png" alt="LunarLander low reward" /> <figcaption>Run1; random seed; Batch size = 256;</figcaption> </figure> <p>Increasing sample size aka batch size achieves significantly higher scores but is still unstable.</p> <figure> <img src="https://raw.githubusercontent.com/syntheticmindAI/syntheticmindAI.github.io/master/_posts/supervisedagents/goodlunarrew.png" alt="LunarLander high reward" /> <figcaption>Run1; random seed; batch size = 2048;</figcaption> </figure> <p>The fact that we can get good results by choosing top K training episodes and iteratively training on its state action pairs, merits further investigation. There may exist other methods of getting high quality data and this is the main focus of this continuing research.</p> <p>The next article in this series will highlight efforts in making the algorithm more stable, data selection, adding more complex test games and conducting experiments on why this works. Some of the planned experiments have already been completed and provide interesting insights.</p> <p><strong><em>At Synthetic Mind, we are pioneering a new way of doing AI research which we call Audience supported research. In addition to free bi monthly articles like this one, we would like to provide more value to our most interested readers. If you would like to support this research, suggest its direction, get more in depth insights, explore further experiments, or would like to get technical support for repurposing the work produced here for your own research problems you can <a href="https://gumroad.com/l/bxJfF">Subscribe</a> to our weekly newsletter for a $10 monthly fee.</em></strong></p> <h4 id="references"> <a href="#references" class="anchor-head"></a> References </h4> <ul> <li><a href="https://arxiv.org/abs/1912.02877">Upside Down RL</a></li> </ul> </div> </article> </main> <small class="post-updated-at">updated_at 01-06-2020</small> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="/resume">resume</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2020</span> <small class="footer_theme-copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> <script src="/assets/js/galite.js"></script> <script> var galite = galite || {}; galite.UA = ""; </script> </div> </body> </html>
